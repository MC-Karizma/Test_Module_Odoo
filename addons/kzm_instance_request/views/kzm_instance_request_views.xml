<odoo>
    <data>
        <!-- explicit list view definition -->

        <record model="ir.ui.view" id="kzm_instance_request_list_view">
            <field name="name">List of instance</field>
            <field name="model">kzm.instance.request</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="create_uid"/>
                    <field name="name"/>
                    <field name="limit_date"/>
                    <field name="cpu"/>
                    <field name="ram"/>
                    <field name="disk"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>


        <!-- explicit search view definition -->

        <record model="ir.ui.view" id="kzm_instance_request_search_view">
            <field name="name">search</field>
            <field name="model">kzm.instance.request</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name"/>
                    <field name="address_ip"/>
                    <field name="state"/>
                </search>
            </field>
        </record>


        <!-- explicit form view definition -->

        <record model="ir.ui.view" id="kzm_instance_request_form_view">
            <field name="name">Request instance</field>
            <field name="model">kzm.instance.request</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button id="button_draft" name="action_draft" string="Draft" type="object" class="oe_highlight"
                                states="S,P"/>
                        <button id="button_submitted" name="action_submitted" string="Submitted" type="object"
                                class="oe_highlight" states="D"/>
                        <button id="button_in_process" name="action_in_process" string="In process" type="object"
                                class="oe_highlight" states="S" groups="kzm_instance_request.group_instance_manager"/>
                        <button id="button_processed" name="action_processed" string="Processed" type="object"
                                class="oe_highlight" states="I_P" groups="kzm_instance_request.group_instance_manager"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="address_ip" attrs="{'invisible': [('state', 'in', ('P','I_P','D'))],'readonly': [('state','=','P')]}"/>
                                <field name="url" attrs="{'readonly': [('state','=','P')]}"/>
                                <field name="name" required="True" attrs="{'readonly': [('state','=','P')]}"/>
                            </group>
                            <group>
                                <field name="cpu" attrs="{'readonly': [('state','=','P')]}"/>
                                <field name="ram" attrs="{'readonly': [('state','=','P')]}"/>
                                <field name="disk" attrs="{'readonly': [('state','=','P')]}"/>
                            </group>
                            <group>
                                <field name="active" attrs="{'readonly': [('state','=','P')]}"/>
                                <field name="state" attrs="{'readonly': [('state','=','P')]}"/>
                                <field name="limit_date" required="True" attrs="{'readonly': [('state','=','P')]}"/>
                            </group>
                            <group rowspan="3">
                                <field name="treat_date" attrs="{'readonly': [('state','=','P')]}"/>
                                <field name="treat_duration" attrs="{'readonly': [('state','=','P')]}"/>
                            </group>
                        </group>
                    </sheet>

                </form>
            </field>
        </record>


        <!-- actions opening views on models -->

        <record model="ir.actions.act_window" id="kzm_instance_request_action_window">
            <field name="name">Instance window</field>
            <field name="res_model">kzm.instance.request</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('create_uid','=',uid)]</field>
        </record>

        <!-- Action ajouter les menus Responsables > À valider : qui affiche toutes les demandes en état Soumises et  En traitement-->

        <record model="ir.actions.act_window" id="kzm_instance_request_action_window_S_IP">
            <field name="name">Request in state submitted or in process</field>
            <field name="res_model">kzm.instance.request</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">['|',('state','=','S'),('state','=','I_P')]</field>
        </record>


        <!-- Action ajouter les menus Responsables > Toutes : qui affiche toutes les demandes-->

        <record model="ir.actions.act_window" id="kzm_instance_request_action_window_all">
            <field name="name">Requests</field>
            <field name="res_model">kzm.instance.request</field>
            <field name="view_mode">tree,form</field>
        </record>


        <!-- Action server  -->
        <record model="ir.actions.server" id="action_server_p">
            <field name="name">Processed</field>
            <field name="model_id" ref="model_kzm_instance_request"/>
            <field name="binding_model_id" ref="model_kzm_instance_request"/>
            <field name="state">code</field>
            <field name="code">
                action = records.action_processed()
            </field>
            <!--<field name="groups_id" eval="[(4, ref('base.group_erp_manager'))]"/>-->
        </record>


         <!-- Action  scheduled -->
        <record id="submitted_cron" model="ir.cron">
            <field name="name">Submitted</field>
            <field name="model_id" ref="model_kzm_instance_request"/>
            <field name="interval_number">1</field>
            <field name="interval_type">minutes</field>
            <field name="type">ir.actions.server</field>
            <field name="numbercall">-1</field>
            <field name="code">model.submitted_cron()</field>
            <field name="state">code</field>
            <field name="active" eval="True"></field>
        </record>


        <!-- server action to the one above -->
        <!--
            <record model="ir.actions.server" id="kzm_instance_request.action_server">
              <field name="name">kzm_instance_request server</field>
              <field name="model_id" ref="model_kzm_instance_request_kzm_instance_request"/>
              <field name="state">code</field>
              <field name="code">
                action = {
                  "type": "ir.actions.act_window",
                  "view_mode": "tree,form",
                  "res_model": model._name,
                }
              </field>
            </record>
        -->

        <!-- Top menu item -->

        <menuitem name="Instance" id="kzm_instance_request.menu_root" />

        <!-- menu categories -->

        <menuitem name="My requests" id="kzm_instance_request_cat" parent="kzm_instance_request.menu_root" groups="kzm_instance_request.group_instance_user"/>
        <!--<menuitem name="Menu 2" id="kzm_instance_request.menu_2" parent="kzm_instance_request.menu_root"/>-->

        <!-- actions -->

        <menuitem name="Display list of request" id="kzm_instance_request_list" parent="kzm_instance_request_cat"
                  action="kzm_instance_request_action_window" groups="kzm_instance_request.group_instance_administrator"/>

        <menuitem name="Manager" id="kzm_instance_manager" parent="kzm_instance_request.menu_root" groups="kzm_instance_request.group_instance_manager"/>
        <menuitem name="To be validated" id="kzm_instance_to_be_validated" parent="kzm_instance_manager"
                  action="kzm_instance_request_action_window_S_IP" groups="kzm_instance_request.group_instance_manager"/>
        <menuitem name="All" id="kzm_instance_all" parent="kzm_instance_manager"
                  action="kzm_instance_request_action_window_all" groups="kzm_instance_request.group_instance_manager"/>


        <menuitem name="Analyse" id="kzm_instance_analyse" parent="kzm_instance_request.menu_root" groups="kzm_instance_request.group_instance_user"/>

        <menuitem name="Configuration" id="kzm_instance_configuration" parent="kzm_instance_request.menu_root" groups="kzm_instance_request.group_instance_administrator"/>

        <!-- <menuitem name="Server to list" id="kzm_instance_request" parent="kzm_instance_request.menu_2"
                   action="kzm_instance_request.action_server"/>
     -->
    </data>
</odoo>